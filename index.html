<!DOCTYPE html>
<html>
<head>
    <title>Игра с MetaMask</title>
</head>
<body>
    <h1>Игра с MetaMask</h1>

    <!-- Подключение актуальной версии Web3.js -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>

    <input type="number" id="amountInput" step="0.0001" placeholder="Сумма для отправки (в ETH)">
    <button onclick="executeTransaction()">Отправить</button>

    <script>
        // Проверка наличия MetaMask
        async function checkMetaMaskAvailability() {
            if (window.ethereum && window.ethereum.isMetaMask) {
                try {
                    // Запрос на подключение к MetaMask
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    console.log('MetaMask доступен!');
                } catch (error) {
                    console.error('Ошибка подключения к MetaMask:', error);
                }
            } else {
                console.error('MetaMask не найден или не установлен.');
            }
        }

        // Выполнение транзакции
        async function executeTransaction() {
            const amountInput = document.getElementById('amountInput');
            const amountEth = amountInput.value;

            try {
                // Получение аккаунта MetaMask
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                const account = accounts[0];

                // Преобразование суммы из ETH в wei
                const weiAmount = web3.utils.toWei(amountEth, 'ether');

                // Создание транзакции
                const transaction = {
                    from: account,
                    to: '0xf3Ac5D4057F6AF98e9a820a99e8Df7C9A214438d', // Замените на фактический адрес получателя
                    value: weiAmount,
                };

                // Отправка транзакции
                const result = await window.ethereum.request({ method: 'eth_sendTransaction', params: [transaction] });
                console.log('Транзакция отправлена:', result);
            } catch (error) {
                console.error('Ошибка при выполнении транзакции:', error);
            }
        }

        // Проверка наличия MetaMask
        checkMetaMaskAvailability();
    </script>
</body>
</html>
